
## Abstract

In real scheduling problems, unexpected changes may occur frequently such as changes in task features. These changes cause deviation from primary scheduling. 
In our report,  three heuristic models, inspired from Artificial Bee Colony algorithm, Genetic algorithm and Simulated Annealing algorithm are proposed for a dynamic flexible job-shop scheduling (DFJSP) problem. This problem consists of n jobs that should be processed by m machines and the processing time of jobs deviates from estimated times. The objective is near-optimal scheduling after any change in tasks in order to minimize the maximal completion time (Makespan). In the proposed model, first, scheduling is done according to the estimated processing times and then re-scheduling is performed after determining the exact ones considering machine set-up. In order to evaluate the performance of the proposed models, some numerical experiments are designed in small, medium and large sizes in different levels of changes in processing times and statistical results illustrate the efficiency of the proposed algorithms.	

## Introduction and Problem Settings

In a flexible job scheduling problem (FJSP), there are multiple stages and multiple machines. In this optimization problem, each job consists of some related operations, thus we need to consider two sub-problems: machine assignment and operation sequence problem. Machine assignment problem allocates an operation to one of the available machines. Operation sequence problem determines the order of all operations on machines considering their relations in order to obtain a feasible and optimal solution.

Below is a simple example of our FJSP problem, there are four jobs, job1 has 3 operations, job 2 has 2 operations, job 3 has 3 operations, job 4 has 2 operations. There are 5 machines. We have two sequence: MA (machine assignment) and JS (job sequence). For instance, in Figure 1, the above sequence represents the machine assignment of each operations, the below represents the job sequence. In figure 2, the Gantt chart is used to show the result of the example.

![image](https://hackmd.io/_uploads/rJNvpS8DT.png =500x)
*Figure 1.*

![image](https://hackmd.io/_uploads/H16AprUvp.png =500x)
*Figure 2.*


In real world problems, the processing time of each operations may be changed due to the nature of the production process, machine set-up, etc. In order to prepare the production planning for the total process, we have to consider the estimated times and update the actual times after machine’s setting. Thus, we let the processing time vary in a range with respect to the current processing time. The variation of processing time may be positive or negative. For instance, if the magnitude of change is 0.25, then the processing time after variation equals the current processing time + Δ,  Δ =r processing time, where r~U(-0.25,0.25).

## Mathematical Model

![image](https://hackmd.io/_uploads/Hk4VAHLw6.png =450x)

![image](https://hackmd.io/_uploads/SymvRSUDp.png =700x)

![image](https://hackmd.io/_uploads/SyatRS8vT.png)


## Algorithms

### Overview

Figure 3 is the overview of the algorithm, it is a time discrete algorithm. First, we generate the initial MA and OS sequence. For MA sequence, we assign the operations to the machine which has the minimum processing time. Besides, the OS sequence is generated randomly.Then, we do the initial scheduling, we use metaheuristic algorithms to improve the OS sequence. After getting the operations sequence, we will adjust the MA sequence with local search algorithm. In each iteration, we need to examine whether the time spot is the beginning time of any operations. If it is true, we should update the processing time and reschedule the remaining operations and their machine assignment. We will do this process iteratively until the end of makespan. (The makespan will also change in each iteration.)


![image](https://hackmd.io/_uploads/ByqxJ8ID6.png)
*Figure 3.*


### Metaheuristics

 - ABC (Artificial Bee Colony)


 - GA (Genetic Algorithm)
The initial population of the genetic algorithm consists of 30 different operations sequence, all of them are generated randomly. The MA sequence is generated by the initialization rule. We calculate the makespan of all these 30 instances. The probability of picking an instance from the population is
![image](https://hackmd.io/_uploads/SkQ31UUwp.png =450x)
which ensures the sequence with a little makespan has a higher probability to be chosen.
In each iteration, we perform crossover by picking two parents from the population pool according to the above probability. We randomly select a point c with a value between c and total number of operations − c and generate two children correspondingly. The first child is a job sequence with the first c jobs identical to the first parent. On the other hand, the second child is a job sequence with the first c jobs identical to the second parent. The remaining jobs are then ordered by the relative order of the first parent. Figure 4 is an example of the children generation process.
![image](https://hackmd.io/_uploads/HkgygIUDT.png)
*Figure 4.*
For each child, we again evaluate the job sequence by the identical processes described in the previous paragraph, including searching for the best neighboring assignment. We then substitute the child for the worst job order in the population pool if the child has a better objective value.
After a predetermined number of iterations, which we set to be 30 in our implementation, we terminate the algorithm. Finally, we propose the best solution in the population pool as the final solution of our heuristic algorithm.


 - SA (Simulated Anealing)


 - Local Search
We find that some of the operations can be processed on more than one machine. Therefore, we check all the combinations for current partial sequence and find the optimal assignment based on the minimum makespan of partial sequence.

 - Dynamic Scheduling
We start from 0 to the end of makespan, in each iteration, we check whether the time spot is the beginning time of any operation. If it is true, we update the processing time (processing time = processing time + Δ), beginning and finishing time of each operation and the makespan. Figure 5 is an example of the update process.
![image](https://hackmd.io/_uploads/BkDsgUIw6.png)
*Figure 5.*
In each iteration, we also fix the partial OS and MA sequence before time t and do the metaheuristic and local search for the remaining sequence. Figure 6 demonstrates how we fix the partial sequence. For MA sequence, we assign the operations in the partial sequence to the determined machines. For OS sequence, we advance the operations in the partial sequence to the front of OS sequence and the remaining operations are then ordered by the relative sequence generated by the rescheduling process.
![image](https://hackmd.io/_uploads/BkBTg8LPT.png)


## Results

## Conclusion

## Reference
1. Melissa Shahgholi Zadeh, Yalda Katebi & Ali Doniavi (2019) "A heuristic model for dynamic flexible job shop scheduling problem considering variable processing times", International Journal of Production Research, 57:10, 3020-3035